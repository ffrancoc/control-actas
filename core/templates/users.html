{% extends 'layout/base.html' %}
{% block title %}
  Usuarios
{% endblock %}
{% block headerbar %}
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb pt-3">
      <li class="breadcrumb-item">
        <a href="{% url 'users' %}" class="text-decoration-none">Usuarios</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">Listado</li>
    </ol>
  </nav>
  <a class="ms-auto btn btn-sm btn-primary" href="{% url 'add_user' %}">Nuevo</a>
{% endblock %}
{% block alerts %}
  {% for message in messages %}
    <div class="alert alert-warning alert-dismissible fade show d-flex p-2" role="alert">
      <i class="bi bi-check-circle-fill me-2"></i> {{ message }}
      <button type="button" class="btn-close btn-sm mt-1 p-2" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
{% endblock %}
{% block content %}
  <div class="flex-grow-1 d-flex flex-column">
    <div id="hacker-list">
      <input class="search form-control" placeholder="🔍 Filtrar ..." />
      <div class="d-flex flex-wrap gap-3 py-2">
        <span class="text-muted">Ordenar por:</span>
        <span class="sort bg-light border p-1 rounded-pill" data-sort="username" style="cursor: pointer; font-size: .8rem;">Usuario</span>
        <span class="sort bg-light border p-1 rounded-pill" data-sort="name" style="cursor: pointer; font-size: .8rem;">Nombre</span>
        <span class="sort bg-light border p-1 rounded-pill" data-sort="admin" style="cursor: pointer; font-size: .8rem;">Administrador</span>
        <span class="sort bg-light border p-1 rounded-pill" data-sort="status" style="cursor: pointer; font-size: .8rem;">Activo</span>
        <span class="sort bg-light border p-1 rounded-pill" data-sort="email" style="cursor: pointer; font-size: .8rem;">Correo</span>
        <span class="sort bg-light border p-1 rounded-pill" data-sort="login" style="cursor: pointer; font-size: .8rem;">Acceso</span>
      </div>

      <ul class="list list-group">
        {% for u in users %}
          <li class="list-group-item list-group-item-action d-flex flex-wrap gap-3">
            <p class="username" style="width: 100px">
              <small class="fw-bold">Usuario</small><br />{{ u.username }}
            </p>
            <p class="name" style="width: 180px">
              <small class="fw-bold">Nombre</small><br />{{ u.first_name }} {{ u.last_name }}
            </p>
            <p class="admin" style="width: 100px">
              <small class="fw-bold">Administrador</small><br />{% if u.is_staff %}
                <i class="bi bi-person-fill-check"></i>
              {% endif %}
            </p>
            <p class="status" style="width: 50px">
              <small class="fw-bold">Activo</small><br />{% if u.is_active %}
                <i class="bi bi-check2"></i>
              {% endif %}
            </p>
            <p class="email" style="width: 200px">
              <small class="fw-bold">Correo</small><br />{{ u.email }}
            </p>
            <p class="login" style="width: 150px">
              <small class="fw-bold">Ultimo Acceso</small><br />{% if u.last_login %}
                {{ u.last_login|date:'M d, Y' }}
              {% endif %}
            </p>
            <p class="actions">
              <small class="fw-bold">Acciones</small><br />
              <a class="me-1" href="#">Editar</a>
              <a class="me-1" href="#">Clave</a>
              <a class="me-1" href="#">Eliminar</a>
            </p>
          </li>
        {% endfor %}
      </ul>
      <ul class="pagination mt-2"></ul>
    </div>
    <div class="border-top pt-2 text-muted">
      <caption>Usuarios registrados: {{ userlen }}</caption>
    </div>
  </div>
{% endblock %}
{% block customscript %}
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      var options = {
        valueNames: ['username', 'name', 'admin', 'status', 'email', 'login'],
        page: 20,
        pagination: true
      }
    
      var hackerList = new List('hacker-list', options)
    })
  </script>
{% endblock %}
